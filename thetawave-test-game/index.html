<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thetawave Test Game</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        canvas {
            display: block;
            width: 1280px;
            height: 720px;
        }
    </style>
    <script>
        // Workaround for browser autoplay policy - resume AudioContext after user interaction
        // See: https://github.com/NiklasEi/bevy_kira_audio/issues/83
        (function() {
            const audioContextList = [];
            const userInputEventNames = [
                "click", "contextmenu", "auxclick", "dblclick",
                "mousedown", "mouseup", "pointerup", "touchend",
                "keydown", "keyup"
            ];

            // Intercept AudioContext creation
            const OriginalAudioContext = window.AudioContext || window.webkitAudioContext;
            if (OriginalAudioContext) {
                window.AudioContext = window.webkitAudioContext = function(...args) {
                    const ctx = new OriginalAudioContext(...args);
                    audioContextList.push(ctx);
                    return ctx;
                };
                window.AudioContext.prototype = OriginalAudioContext.prototype;
            }

            // Resume all AudioContexts on user interaction
            function resumeAllContexts() {
                audioContextList.forEach(ctx => {
                    if (ctx.state === "suspended") {
                        ctx.resume();
                    }
                });
            }

            userInputEventNames.forEach(eventName => {
                document.addEventListener(eventName, resumeAllContexts, { capture: true });
            });
        })();
    </script>
</head>
<body>
    <canvas id="bevy"></canvas>
</body>
</html>